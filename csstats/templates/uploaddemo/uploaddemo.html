<div class="col d-flex justify-content-center">
  <h1>Загрузка дем-файла</h1>
  <form method="post" enctype="multipart/form-data" id="demoUploadForm">
      {% csrf_token %}
      <input type="file" name="file" id="demoFileInput" accept=".dem" required>
      <input type="hidden" name="file_mtime" id="fileMtime">
      <button type="submit">Загрузить</button>
  </form>
  <p id="fileError" style="color: red; display: none;">Пожалуйста, выберите файл с расширением .dem</p>
</div>

<script>
  document.getElementById('demoFileInput').addEventListener('change', function(e) {
      const fileInput = e.target;
      const fileError = document.getElementById('fileError');
      const mtimeInput = document.getElementById('fileMtime');
      
      const fileName = fileInput.value.toLowerCase();
      if (!fileName.endsWith('.dem')) {
          fileError.style.display = 'block';
          fileInput.value = '';
      } else {
          fileError.style.display = 'none';
          
          if (fileInput.files.length > 0) {
              const file = fileInput.files[0];
              mtimeInput.value = file.lastModified;
          }
      }
  });

  document.getElementById('demoUploadForm').addEventListener('submit', function(e) {
      const fileInput = document.getElementById('demoFileInput');
      if (!fileInput.value.toLowerCase().endsWith('.dem')) {
          e.preventDefault();
          document.getElementById('fileError').style.display = 'block';
      }
  });
</script>